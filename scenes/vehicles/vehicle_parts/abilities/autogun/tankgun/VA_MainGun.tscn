[gd_scene load_steps=3 format=3 uid="uid://xjfe312p220y"]

[ext_resource type="PackedScene" uid="uid://dlvi34ij1dsbu" path="res://scenes/vehicles/vehicle_parts/abilities/autogun/autogun_projectiles/projectile_raycast/projectile_raycast.tscn" id="2_mnho6"]

[sub_resource type="GDScript" id="GDScript_etv62"]
script/source = "class_name AutoGunAbility
extends AbilityLogic

@export var projectileScene : PackedScene
@export var smokeParticleScene : PackedScene

func activate(inputPressed : bool = false) -> bool:
	autoFiring = inputPressed if canAutofire else false
	if _currentState != ABILITY_STATE.READY:
		return false
	_enter_active()
	var projectile : Projectile = projectileScene.instantiate() as Projectile

	get_tree().get_root().add_child(projectile)

	projectile.initialise(hardPoint.global_position, hardPoint.global_rotation, ownerEntity)

	if smokeParticleScene:
		var smoke : GunSmokeParticle = smokeParticleScene.instantiate()
		get_tree().get_root().add_child(smoke)
		smoke.initialise(hardPoint.global_position, hardPoint.global_rotation)
		
	_enter_cooldown()
	return true
"

[node name="MainGun" type="Node3D"]
script = SubResource("GDScript_etv62")
projectileScene = ExtResource("2_mnho6")

[node name="Cooldown" type="Timer" parent="."]
unique_name_in_owner = true
one_shot = true

[node name="ActivateSFXPlayer" type="AudioStreamPlayer3D" parent="."]
unique_name_in_owner = true
